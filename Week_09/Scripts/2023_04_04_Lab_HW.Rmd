---
title: "2023_04_04_Lab_HW"
author: "Cindy Fajardo"
date: '`r Sys.Date()`'
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE,
                      warning = FALSE,
                      message = FALSE,
                      fig.path = "../Output/")
```


# Libraries
```{r}
library(tidyverse)
library(PNWColors)
library(here)
library(nationalparkcolors)
library(hrbrthemes)
```


# Read in the data
I read in data sets I used in Biometry
```{r}
surf_perch <- read_csv(here("Week_09","Data","surfperch_mating.csv"))
snail_data <- read_csv(here("week_09","Data","SnailData.csv"))
algea_data <- read_csv(here("Week_09","Data","algae.csv"))
```

# Let's make a non-plot function
While I was out in the field this past Friday, I realized that the calipers I was using were in cm. Most of the work on owl limpets is in mm. So I decided to make a function that converts cm to mm that could be used in different data frames and could be used when you need to convert cm to mm really quick.
```{r}
cm_to_mm <- function(x) {lenght_mm <- (x * 10) #converts cm to mm
return(lenght_mm)
}

surf_perch %>% 
  mutate(male_size_mm = cm_to_mm(male_size)) #used it wih surf perch data

snail_data %>% 
  mutate(lenght_mm = cm_to_mm(Length)) #used it with snail data

cm_to_mm(48)

```

# Lets make a plot function
```{r, Plot Function}
algea_clean <- algea_data %>% 
  mutate(log_Surface_area = log(Surface_area)) #took log of surface area to make numbers smaller

bubble_plot <- function(data, x, y, size, color){ #named plot function and set data that needs to be inputed into function
park_colors<-park_palette("BlueRidgePkwy") #made my palette

ggplot(algea_clean, #data used
       aes(x = {{x}}, #what x could be
           y = {{y}}, #what y could be
           size = {{size}}, #what size could be
           color = {{color}}))+ #what color could be
  geom_point(alpha=0.5, shape=19)+ #changed shape and transparancy 
  scale_size(range = c(.1, 24))+ # add bubbles
  scale_color_manual("BlueRidgePkwy", values=park_colors, guide=FALSE)+   # use pretty colors and change the legend title
  theme_ipsum()+ # chose ipsum theme
    theme(legend.position = "none")+ #no legend
  ylab("Log of Surface Area")+ #changed y label
  labs(title = "Bubble Graph") #added title
}
bubble_plot(data = algea_clean, x = Height, y = log_Surface_area, size = Volume, color = Site)
```

